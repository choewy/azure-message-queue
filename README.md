# Azure Message Queue

## 개요

1. 서버 A, B가 있다.
2. 서버 A는 API 서버이고, 서버 B는 메시지 브로커 서버이다.
3. 서버 A는 mp4 파일을 유튜브로 업로드 후, 영상 링크를 DB에 저장하여야 한다.
4. mp4 파일을 유튜브에 업로드 하는 과정에서 여러 프로세스를 사용하여야 하므로, 해당 작업을 서버 B에게 넘기고자 한다(서버 B는 복제가 가능한 컨테이너로 동작한다).
5. 이를 위해 Azure Message Queue를 사용하였다.

## 시나리오

1. 클라이언트는 서버 A로 mp4 파일의 메타데이터를 넘긴다.
2. 서버 A는 유튜브 영상 링크를 DB에 저장하기 위하여 빈 ROW를 생성한 후 서버 B에게 PK를 넘겨준다.
3. 서버 B는 mp4 파일을 유튜브에 업로드하고(2초 소요), 서버 A에게 해당 ROW의 상태를 in-progress롤 변경하도록 메시지를 전달한다(Queue 처리 순서를 기다리는 시간이 1초라고 가정한다).
4. 서버 B는 유튜브에 업로드가 성공한 후 생성된 링크를 서버 A에게 넘긴다.
